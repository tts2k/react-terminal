import e,{createContext as n,createElement as t,useEffect as r,useState as o,useContext as a,useRef as i}from"react";import l from"prop-types";import{isMobile as c}from"react-device-detect";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var u=function(){return(u=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function s(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===t&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}('.index_editor__2tqRz {\n  text-align: left;\n  height: 100%;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  -ms-overflow-style: none;\n  scrollbar-width: none; }\n  .index_editor__2tqRz::-webkit-scrollbar {\n    display: none; }\n  .index_editor__2tqRz .index_mobileInput__jGtyc {\n    position: absolute;\n    top: -2000px;\n    left: -2000px; }\n  .index_editor__2tqRz .index_lineText__2Poex {\n    display: inline;\n    position: relative;\n    top: -0.0625em;\n    margin-left: 0.5em; }\n  .index_editor__2tqRz .index_preWhiteSpace__3nCT2 {\n    white-space: pre-wrap; }\n  .index_editor__2tqRz .index_caret__MYxcn {\n    position: relative;\n    animation: index_blink__RQDX- 0.75s ease-in-out infinite; }\n    .index_editor__2tqRz .index_caret__MYxcn .index_caretAfter__2B8sk {\n      background: currentColor;\n      content: "";\n      position: absolute;\n      top: 0.125em;\n      width: 0.125em;\n      height: 1.175em;\n      z-index: 10; }\n\n@keyframes index_blink__RQDX- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0); }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none; } }\n  .index_editor__2tqRz a {\n    color: inherit;\n    text-decoration: underline; }\n\n#index_terminalContainer__3q4m3 {\n  height: 100%; }\n\n.index_terminal__1dSq1 {\n  height: 100%;\n  width: 100%;\n  margin: auto; }\n');var m={editor:"index_editor__2tqRz",mobileInput:"index_mobileInput__jGtyc",lineText:"index_lineText__2Poex",preWhiteSpace:"index_preWhiteSpace__3nCT2",caret:"index_caret__MYxcn",blink:"index_blink__RQDX-",caretAfter:"index_caretAfter__2B8sk",terminalContainer:"index_terminalContainer__3q4m3",terminal:"index_terminal__1dSq1"},d=n(null),p=function(e){var n=e.children;return t(d.Provider,{value:m},n)},f={dark:{background:"#022833",color:"#839496",promptColor:"#a917a8",fontFamily:"monospace",fontSize:"18px",lineHeight:"1.5",padding:"1em"},light:{background:"#fdf6e4",themeToolbarColor:"#d8d8d8",color:"#333333",promptColor:"#a917a8",fontFamily:"monospace",fontSize:"18px",lineHeight:"1.5",padding:"1em"},"material-dark":{background:"#151515",themeToolbarColor:"#424242",color:"#fff",promptColor:"#42A5F5",fontFamily:"monospace",fontSize:"18px",lineHeight:"1.5",padding:"1em"},"material-light":{background:"#fafafa",themeToolbarColor:"#424242",color:"#151515",promptColor:"#42A5F5",fontFamily:"monospace",fontSize:"18px",lineHeight:"1.5",padding:"1em"},"material-ocean":{background:"#263238",themeToolbarColor:"#37474F",color:"#fff",promptColor:"#C3D82C",fontFamily:"monospace",fontSize:"18px",lineHeight:"1.5",padding:"1em"},matrix:{background:"#0D0208",themeToolbarColor:"#0D0208",color:"#00FF41",promptColor:"#008F11",fontFamily:"monospace",fontSize:"18px",lineHeight:"1.5",padding:"1em"}},h=n(null),g=function(e){var n=e.children,r=u(u({},f),n.props.themes||{}),o=r[n.props.theme]||r.light;return t(h.Provider,{value:o},n)},_=n(null),x=function(n,t,o,i,l,c,u){var m=a(_),p=m.bufferedContent,f=m.setBufferedContent,g=e.useContext(d),x=e.useContext(h);r((function(){if(n){var r,a,m,d,h;r=i,a=void 0,m=void 0,h=function(){var n,a,m,d,h,_,v,b;return s(this,(function(s){switch(s.label){case 0:return n=r.trim().split(" "),a=n[0],m=n.slice(1),d="","clear"===a?(f(""),l(""),t(!1),[2]):(h=e.createElement(e.Fragment,null,p,e.createElement("span",{style:{color:x.promptColor}},o),e.createElement("span",{className:g.lineText+" "+g.preWhiteSpace},i),e.createElement("br",null)),f(h),l(""),r?(_=m.join(" "),a&&c[a]?"function"!=typeof(v=c[a])?[3,2]:[4,v(_)]:[3,4]):[3,7]);case 1:return d=s.sent(),[3,3];case 2:d=v,s.label=3;case 3:return[3,7];case 4:return"function"!=typeof u?[3,6]:[4,u(_)];case 5:return d=s.sent(),[3,7];case 6:d=u,s.label=7;case 7:return b=e.createElement(e.Fragment,null,p,e.createElement("span",{style:{color:x.promptColor}},o),e.createElement("span",{className:g.lineText+" "+g.preWhiteSpace},i),d?e.createElement("span",null,e.createElement("br",null),d):null,e.createElement("br",null)),f(b),t(!1),[2]}}))},new((d=void 0)||(d=Promise))((function(e,n){function t(e){try{o(h.next(e))}catch(e){n(e)}}function r(e){try{o(h.throw(e))}catch(e){n(e)}}function o(n){n.done?e(n.value):new d((function(e){e(n.value)})).then(t,r)}o((h=h.apply(a,m||[])).next())}))}}),[n])},v=function(n,t,o,i,l,u){var s=e.useContext(d),m=e.useContext(h),p=e.useContext(_).appendCommandToHistory,f=e.useRef(null),g=e.useState(""),v=g[0],b=g[1],y=e.useState(!1),C=y[0],w=y[1];e.useEffect((function(){c&&t&&f.current.focus()}),[t]),e.useEffect((function(){C&&p(v)}),[C]);var E=c&&u?e.createElement("div",{className:s.mobileInput},e.createElement("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:v,onChange:function(e){return b(e.target.value)},ref:f})):null,k=C?e.createElement(e.Fragment,null,E,e.createElement("div",{className:s.lineText},t&&n?e.createElement("span",{className:s.caret},e.createElement("span",{className:s.caretAfter,style:{background:m.color}})):null)):e.createElement(e.Fragment,null,E,e.createElement("span",{style:{color:m.promptColor}},o),e.createElement("div",{className:s.lineText},e.createElement("span",{className:s.preWhiteSpace},v),t&&n?e.createElement("span",{className:s.caret},e.createElement("span",{className:s.caretAfter})):null));return function(e,n,t,o,i){var l=a(_),c=l.getPreviousCommand,u=l.getNextCommand,s=function(r){if(e&&i){r.preventDefault();var a=r.key;if("Enter"!==a){var l=null;l="Backspace"===a?n.slice(0,-1):"ArrowUp"===a?c():"ArrowDown"===a?u():a&&1===a.length?n+a:n,t(l),o(!1)}else o(!0)}};r((function(){return document.addEventListener("keydown",s),function(){document.removeEventListener("keydown",s)}}))}(t,v,b,w,u),x(C,w,o,v,b,i,l),k};function b(n){var r,o=i(null),l=a(d),c=a(h),u=a(_).bufferedContent;!function(n,t){e.useEffect((function(){t.current.scrollTop=t.current.scrollHeight}),[n])}(u,o);var s=n.enableInput,m=n.caret,p=n.consoleFocused,f=n.prompt,g=n.commands,x=n.welcomeMessage,b=n.errorMessage,y=v(m,p,f,g,b,s);return t("div",{ref:o,className:""+l.editor,style:{background:c.background,fontFamily:c.fontFamily,fontSize:c.fontSize,lineHeight:c.lineHeight,padding:null!==(r=c.padding)&&void 0!==r?r:"1em"}},x,u,y)}function y(e){var n,l,u,s,m=i(null),p=o(!c),f=p[0],g=p[1],_=a(d),x=a(h);n=m,l=f,u=g,s=function(e){n.current&&!n.current.contains(e.target)?u(!1):u(!c||!l)},r((function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}}));var v=e.caret,y=e.theme,C=e.prompt,w=e.commands,E=e.welcomeMessage,k=e.errorMessage,T=e.enableInput,F=e.onFocusChange;r((function(){F()}),[f]);var S=t(b,{caret:v,consoleFocused:f,prompt:C,commands:w,welcomeMessage:E,errorMessage:k,enableInput:T});return t("div",{ref:m,id:_.terminalContainer,className:_["theme--"+y]},t("div",{className:""+_.terminal,style:{color:x.color}},S))}function C(e){var n=e.children;return t(p,null,t(g,null,n))}function w(e){return t(C,null,t(y,u({},e)))}y.propTypes={enableInput:l.bool,caret:l.bool,theme:l.string,prompt:l.string,commands:l.objectOf(l.oneOfType([l.string,l.func,l.node])),welcomeMessage:l.oneOfType([l.string,l.func,l.node]),errorMessage:l.oneOfType([l.string,l.object]),onFocusChange:l.func},y.defaultProps={enableInput:!0,caret:!0,theme:"light",prompt:"~$",commands:{},welcomeMessage:"",errorMessage:"Command not found.",onFocusChange:function(){}};var E=function(e){var n=e.children,a=o(""),i=a[0],l=a[1],c=o([]),u=c[0],s=c[1],m=o(null),d=m[0],p=m[1];r((function(){p(u.length)}),[u]);return t(_.Provider,{value:{bufferedContent:i,setBufferedContent:l,appendCommandToHistory:function(e){e&&s(u.concat(e))},getPreviousCommand:function(){if(0===d)return 0===u.length?"":u[0];var e=u[d-1];return d>0&&p(d-1),e},getNextCommand:function(){if(d+1<=u.length){if(d===u.length)return"";var e=u[d+1];return p(d+1),e}return""}}},n)},k={ReactTerminal:w,TerminalContextProvider:E};export default k;export{w as ReactTerminal,E as TerminalContextProvider};
